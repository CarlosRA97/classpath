dnl Input file for autoconf to create the configure script.

AC_INIT(native/java.net/javanet.c)
AM_INIT_AUTOMAKE(classpath, 0.0)

# this file is empty, is this supposed to be here? -gcb
#AM_CONFIG_HEADER(native/config.h)

AC_PREFIX_DEFAULT(/usr/local/classpath)

AC_CANONICAL_HOST

dnl Initialize libtool
AM_PROG_LIBTOOL

dnl Checks for programs.
dnl AC_PROG_CXX
AC_PROG_AWK
AC_PROG_CC
AC_PROG_CPP
AC_PROG_INSTALL
AC_PROG_LN_S
AC_PROG_MAKE_SET
AC_HEADER_STDC
AC_CHECK_HEADERS(unistd.h)
AC_C_CONST
AC_CHECK_FUNCS(gethostname socket strerror)

AC_ARG_WITH(sun-jdk,
 [  --with-sun-jdk          Specify the path to the JDK installation directory],
  [
    if test -f ${withval}/include/jni.h; then
      AC_MSG_RESULT(Using JNI headers in ${withval}/include)
      VMINCLUDE=${withval}/include
      AC_PREFIX_PROGRAM(java)
    else
      AC_MSG_ERROR([Unable to find ${withval}/include/jni.h. Use --with-sun-jdk=/path/to/jdk])
    fi
  ])


AC_ARG_WITH(japhar,
 [  --with-japhar           Specify the path to the Japhar installation directory],
  [
    if test -f ${withval}/include/japhar/jni.h; then
      AC_MSG_RESULT(Using JNI headers in ${withval}/include/japhar)
      VMINCLUDE=${withval}/include/japhar
      AC_PREFIX_PROGRAM(japhar)
    else
      AC_MSG_ERROR([Unable to find ${withval}/include/japhar/jni.h. Use --with-japhar=/path/to/japhar])
    fi
  ])

if test VMINCLUDE = ""
then
  AC_MSG_ERROR(Unable to find include directory for JVM)
fi

# This is the path to the chosen VM's include directory where jni.h
# and others can be found
AC_SUBST(VMINCLUDE)

dnl AC_ARG_WITH(japhar, Install as class library for Japhar, 
dnl             AC_PREFIX_PROGRAM(japhar))
dnl AC_ARG_WITH(sunjdk, Install as class library for Sun's JDK,
dnl             AC_PREFIX_PROGRAM(java))

dnl if test prefix = ""
dnl then
dnl   AC_PREFIX_PROGRAM(japhar)
dnl fi

if test prefix = ""
then
  AC_MSG_ERROR(Unable to locate Virtual Machine to configure for)
fi

AC_OUTPUT(compat/java.net/Makefile
compat/Makefile
Makefile
gnu/java/io/Makefile
gnu/java/lang/reflect/Makefile
gnu/java/lang/Makefile
gnu/java/Makefile
gnu/java/net/content/text/Makefile
gnu/java/net/content/Makefile
gnu/java/net/Makefile
gnu/java/net/http/Makefile
gnu/Makefile
gnu/tools/serialver/Makefile
gnu/tools/Makefile
java/io/Makefile
java/lang/reflect/Makefile
java/lang/Makefile
java/Makefile
java/math/Makefile
java/net/Makefile
java/util/Makefile
native/Makefile
native/java.io/Makefile
native/java.lang.reflect/Makefile
native/java.net/Makefile
native/lib/Makefile
test/java.io/Makefile
test/Makefile
test/gnu.java.lang.reflect/Makefile
test/java.lang.reflect/Makefile
test/java.net/Makefile
test/java.util/Makefile)
